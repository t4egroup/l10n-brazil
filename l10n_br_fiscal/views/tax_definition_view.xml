<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="tax_definition_tree" model="ir.ui.view">
        <field name="name">l10n_br_fiscal.tax.definition.tree</field>
        <field name="model">l10n_br_fiscal.tax.definition</field>
        <field name="arch" type="xml">
            <tree>
                <field invisible="1" name="state"/>
                <field name="tax_group_id"/>
                <field name="is_taxed"/>
                <field name="tax_id"/>
                <field name="cst_code"/>
            </tree></field>
    </record>
    <record id="tax_definition_icms_tree" model="ir.ui.view">
        <field name="name">l10n_br_fiscal.tax.definition.icms.tree</field>
        <field name="model">l10n_br_fiscal.tax.definition</field>
        <field name="arch" type="xml">
            <tree decoration-info="state in ('draft', 'review')" decoration-muted="state == 'expired'">
                <field invisible="1" name="state"/>
                <field invisible="1" name="tax_group_id"/>
                <field name="state_from_id"/>
                <field name="state_to_ids"/>
                <field name="tax_id"/>
                <field name="cst_code"/>
            </tree></field>
    </record>
    <record id="tax_definition_form" model="ir.ui.view">
        <field name="name">l10n_br_fiscal.tax.definition.form</field>
        <field name="model">l10n_br_fiscal.tax.definition</field>
        <field name="arch" type="xml">
            <form string="Tax Definition">
                <field invisible="1" name="company_id"/>
                <field invisible="1" name="icms_regulation_id"/>
                <field invisible="1" name="tax_domain"/>
                <header>
                    <button class="oe_highlight" groups="l10n_br_fiscal.group_manager" invisible="state not in ['draft']" name="action_review" string="Review" type="object"/>
                    <button class="oe_highlight" groups="l10n_br_fiscal.group_manager" invisible="state not in ['review','expired']" name="action_approve" string="Approve" type="object"/>
                    <button class="oe_highlight" groups="l10n_br_fiscal.group_manager" invisible="state not in ['review','approved']" name="action_draft" string="Reset To Draft" type="object"/>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <group>
                        <field force_save="1" name="tax_group_id" options="{'no_create': True, 'no_create_edit': True}" readonly="icms_regulation_id != False"/>
                        <field invisible="1" name="type_in_out"/>
                        <field name="is_taxed"/>
                        <field invisible="is_taxed == False" name="is_debit_credit"/>
                        <field name="custom_tax"/>
                        <field invisible="custom_tax == False" name="tax_id" required="custom_tax == True"/>
                        <field force_save="1" invisible="custom_tax == False or tax_domain not in ('icmssn', 'icms', 'ipi', 'pis', 'pisst', 'cofins', 'cofinsst')" name="cst_id" options="{'no_create': True, 'no_create_edit': True}" required="custom_tax == True and tax_domain in ('icms', 'ipi', 'pis', 'pisst', 'cofins', 'cofinsst')"/>
                        <field invisible="tax_domain != 'ipi'" name="ipi_guideline_id" options="{'no_create': True, 'no_create_edit': True}"/>
                        <field invisible="tax_domain != 'icms'" name="is_benefit"/>
                    </group>
                    <group invisible="is_benefit == False" name="tax_benefit" string="Tax Benefit">
                        <field name="code" required="is_benefit != False"/>
                        <field name="description" required="is_benefit != False"/>
                        <field name="benefit_type" required="is_benefit != False"/>
                    </group>
                    <group invisible="icms_regulation_id == False" name="state" string="State">
                        <field name="state_from_id" options="{'no_create': True, 'no_create_edit': True}"/>
                        <field name="state_to_ids" options="{'no_create': True}"/>
                    </group>
                    <notebook>
                        <page name="ncms_page" string="NCM">
                            <group name="ncms" string="NCMs">
                                <label for="ncms"/>
                                <div class="o_row">
                                    <field class="oe_inline" force_save="1" name="ncms"/>
                                    <button aria-label="Search NCMs" class="oe_inline btn-sm btn-link mb4 fa fa-search oe_edit_only" name="action_search_ncms" title="Search NCMs" type="object"/>
                                </div>
                                <field colspan="2" force_save="1" name="ncm_ids" nolabel="1" options="{'no_create': True}"/>
                                <field name="ncm_exception"/>
                                <field name="not_in_ncms"/>
                            </group>
                        </page>
                        <page name="nbm_page" string="NBM">
                            <group name="nbms" string="NBMs">
                                <label for="nbms"/>
                                <div class="o_row">
                                    <field class="oe_inline" force_save="1" name="nbms"/>
                                    <button aria-label="Search NBMs" class="oe_inline btn-sm btn-link mb4 fa fa-search oe_edit_only" name="action_search_nbms" title="Search NBMs" type="object"/>
                                </div>
                                <field colspan="2" force_save="1" name="nbm_ids" nolabel="1" options="{'no_create': True}"/>
                                <field name="not_in_nbms"/>
                            </group>
                        </page>
                        <page name="cests_page" string="CEST">
                            <group name="cests" string="CESTs">
                                <label for="cests"/>
                                <div class="o_row">
                                    <field class="oe_inline" force_save="1" name="cests"/>
                                    <button aria-label="Search CESTs" class="oe_inline btn-sm btn-link mb4 fa fa-search oe_edit_only" name="action_search_cests" title="Search CESTs" type="object"/>
                                </div>
                                <field colspan="2" force_save="1" name="cest_ids" nolabel="1" options="{'no_create': True}"/>
                            </group>
                        </page>
                        <page name="city_taxation_codes_page" string="City Taxation Code">
                            <group name="city_taxation_codes" string="City Taxation Codes">
                                <field colspan="2" force_save="1" name="city_taxation_code_ids" nolabel="1"/>
                            </group>
                        </page>
                        <page name="products_page" string="Product">
                            <group name="products" string="Products">
                                <field colspan="2" force_save="1" name="product_ids" nolabel="1"/>
                            </group>
                        </page>
                        <page name="fiscal_profile_page" string="Fiscal Profile">
                            <group name="fiscal_profile" string="Fiscal Profile">
                                <field name="ind_final"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field groups="base.group_user" name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form></field>
    </record>
</odoo>
